<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teste - Sistema de Login - Na Régua</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        .test-container {
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }
        .test-section h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 10px;
            margin-bottom: 15px;
        }
        .test-info {
            background: var(--background-warm);
            padding: 15px;
            border-left: 4px solid var(--neon-orange);
            margin: 10px 0;
        }
        .test-credentials {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
        .test-credentials code {
            background: #e0e7ff;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: monospace;
        }
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        .status-ok { background: var(--success-color); }
        .status-error { background: var(--danger-color); }
        .test-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <i class="fas fa-cut"></i>
                    <span>Na Régua - Testes</span>
                </div>
                <ul class="nav-menu">
                    <li><a href="index.html" class="nav-link">Início</a></li>
                    <li><a href="pages/login.html" class="nav-link">Login</a></li>
                    <li><a href="pages/cadastro.html" class="nav-link">Cadastro</a></li>
                </ul>
            </div>
        </nav>
    </header>

    <main class="page-main">
        <div class="test-container">
            <h1 style="text-align: center; color: var(--primary-color); margin-bottom: 30px;">
                <i class="fas fa-vial"></i> Painel de Testes - Sistema de Login
            </h1>

            <!-- Status do Sistema -->
            <div class="test-section">
                <h2><i class="fas fa-heartbeat"></i> Status do Sistema</h2>
                <div id="systemStatus">
                    <p><span class="status-indicator status-ok"></span> Database: <span id="dbStatus">Verificando...</span></p>
                    <p><span class="status-indicator" id="authIndicator"></span> Autenticação: <span id="authStatus">Verificando...</span></p>
                    <p><span class="status-indicator status-ok"></span> LocalStorage: <span id="storageStatus">Verificando...</span></p>
                </div>
            </div>

            <!-- Informações de Login -->
            <div class="test-section">
                <h2><i class="fas fa-user-circle"></i> Usuário Atual</h2>
                <div id="currentUserInfo">
                    <p id="userInfo">Nenhum usuário logado</p>
                </div>
                <div class="test-buttons">
                    <button class="btn btn-primary" onclick="checkLogin()">
                        <i class="fas fa-sync"></i> Verificar Login
                    </button>
                    <button class="btn btn-danger" onclick="doLogout()">
                        <i class="fas fa-sign-out-alt"></i> Fazer Logout
                    </button>
                </div>
            </div>

            <!-- Contas de Teste -->
            <div class="test-section">
                <h2><i class="fas fa-users"></i> Contas de Teste</h2>
                <div class="test-info">
                    <p><strong>Use estas credenciais para testar o sistema:</strong></p>
                </div>
                
                <h3 style="color: var(--primary-color); margin: 15px 0;">Clientes</h3>
                
                <div class="test-credentials">
                    <h4>Conta 1 - João da Silva (Cliente)</h4>
                    <p><strong>Tipo:</strong> Cliente</p>
                    <p><strong>Email:</strong> <code>joao@email.com</code></p>
                    <p><strong>Senha:</strong> <code>123456</code></p>
                    <button class="btn btn-secondary btn-sm" onclick="loginAs('joao@email.com', '123456')">
                        <i class="fas fa-sign-in-alt"></i> Login Rápido
                    </button>
                </div>

                <div class="test-credentials" style="margin-top: 15px;">
                    <h4>Conta 2 - Maria Santos (Cliente)</h4>
                    <p><strong>Tipo:</strong> Cliente</p>
                    <p><strong>Email:</strong> <code>maria@email.com</code></p>
                    <p><strong>Senha:</strong> <code>123456</code></p>
                    <button class="btn btn-secondary btn-sm" onclick="loginAs('maria@email.com', '123456')">
                        <i class="fas fa-sign-in-alt"></i> Login Rápido
                    </button>
                </div>

                <h3 style="color: var(--neon-orange); margin: 20px 0 15px 0;">Barbeiros</h3>
                <div class="test-info" style="background: #fff8e1;">
                    <p><strong>Para testar como barbeiro, cadastre-se em:</strong> 
                    <a href="pages/cadastro-barbeiro.html" class="btn btn-primary btn-sm" style="margin-left: 10px;">
                        <i class="fas fa-user-tie"></i> Cadastro de Barbeiro
                    </a></p>
                </div>
            </div>

            <!-- Dados do Sistema -->
            <div class="test-section">
                <h2><i class="fas fa-database"></i> Dados do Sistema</h2>
                <div id="systemData">
                    <p><strong>Total de Clientes:</strong> <span id="totalClientes">0</span></p>
                    <p><strong>Total de Barbeiros Cadastrados:</strong> <span id="totalBarbeirosAuth">0</span></p>
                    <p><strong>Total de Agendamentos:</strong> <span id="totalAgendamentos">0</span></p>
                    <p><strong>Total de Barbeiros (Padrão):</strong> <span id="totalBarbeiros">3</span></p>
                    <p><strong>Total de Serviços:</strong> <span id="totalServicos">4</span></p>
                </div>
                <div class="test-buttons">
                    <button class="btn btn-secondary" onclick="loadSystemData()">
                        <i class="fas fa-sync"></i> Atualizar
                    </button>
                    <button class="btn btn-warning" onclick="resetDatabase()">
                        <i class="fas fa-redo"></i> Resetar Database
                    </button>
                    <button class="btn btn-danger" onclick="clearAll()">
                        <i class="fas fa-trash"></i> Limpar Tudo
                    </button>
                </div>
            </div>

            <!-- Links Úteis -->
            <div class="test-section">
                <h2><i class="fas fa-link"></i> Links Rápidos</h2>
                <div class="test-buttons">
                    <a href="index.html" class="btn btn-outline">
                        <i class="fas fa-home"></i> Página Inicial
                    </a>
                    <a href="pages/cadastro.html" class="btn btn-outline">
                        <i class="fas fa-user-plus"></i> Cadastro
                    </a>
                    <a href="pages/login.html" class="btn btn-outline">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </a>
                    <a href="pages/cadastro-barbeiro.html" class="btn btn-outline">
                        <i class="fas fa-user-tie"></i> Cadastro Barbeiro
                    </a>
                    <a href="pages/agendamento.html" class="btn btn-outline">
                        <i class="fas fa-calendar-plus"></i> Agendamento
                    </a>
                    <a href="pages/painel.html" class="btn btn-outline">
                        <i class="fas fa-chart-line"></i> Painel Cliente
                    </a>
                    <a href="pages/painel-barbeiro.html" class="btn btn-outline">
                        <i class="fas fa-chart-line"></i> Painel Barbeiro
                    </a>
                </div>
            </div>

            <!-- Instruções -->
            <div class="test-section">
                <h2><i class="fas fa-book"></i> Instruções de Teste</h2>
                <ol style="line-height: 2;">
                    <li><strong>Como Cliente:</strong> Use uma conta de teste ou crie uma nova</li>
                    <li>Faça login e você será direcionado para agendamento</li>
                    <li>Faça um agendamento e veja no "Painel Cliente"</li>
                    <li>Note que você só vê seus próprios agendamentos</li>
                    <li><strong>Como Barbeiro:</strong> Cadastre-se em "Cadastro de Barbeiro"</li>
                    <li>Após login, será direcionado para o "Painel do Barbeiro"</li>
                    <li>No painel do barbeiro você vê TODOS os agendamentos</li>
                    <li>Pode confirmar, iniciar, concluir ou cancelar agendamentos</li>
                    <li>Veja estatísticas detalhadas de seus atendimentos</li>
                    <li>Exporte relatórios em CSV</li>
                </ol>
            </div>
        </div>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-cut"></i>
                    <span>Na Régua</span>
                </div>
                <p>&copy; 2025 Na Régua. Sistema de Teste.</p>
            </div>
        </div>
    </footer>

    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script>
        // Verificar status do sistema ao carregar
        document.addEventListener('DOMContentLoaded', function() {
            checkSystemStatus();
            checkLogin();
            loadSystemData();
        });

        function checkSystemStatus() {
            // Database
            try {
                const clientes = window.db.getClientes();
                document.getElementById('dbStatus').textContent = 'Operacional';
            } catch (e) {
                document.getElementById('dbStatus').textContent = 'Erro: ' + e.message;
            }

            // Autenticação
            const authIndicator = document.getElementById('authIndicator');
            const authStatus = document.getElementById('authStatus');
            if (window.auth && window.auth.isAuthenticated()) {
                authIndicator.className = 'status-indicator status-ok';
                authStatus.textContent = 'Usuário Logado';
            } else {
                authIndicator.className = 'status-indicator status-error';
                authStatus.textContent = 'Nenhum Usuário Logado';
            }

            // LocalStorage
            try {
                localStorage.setItem('test', 'test');
                localStorage.removeItem('test');
                document.getElementById('storageStatus').textContent = 'Disponível';
            } catch (e) {
                document.getElementById('storageStatus').textContent = 'Indisponível';
            }
        }

        function checkLogin() {
            const userInfo = document.getElementById('userInfo');
            if (window.auth && window.auth.isAuthenticated()) {
                const user = window.auth.getCurrentUser();
                userInfo.innerHTML = `
                    <div class="test-info">
                        <p><strong>Nome:</strong> ${user.nome}</p>
                        <p><strong>Email:</strong> ${user.email}</p>
                        <p><strong>ID:</strong> ${user.id}</p>
                        <p><strong>Telefone:</strong> ${user.telefone}</p>
                    </div>
                `;
            } else {
                userInfo.innerHTML = '<p style="color: var(--danger-color);">Nenhum usuário logado</p>';
            }
            checkSystemStatus();
        }

        function loginAs(email, senha) {
            const result = window.auth.login(email, senha);
            if (result.success) {
                Utils.showNotification(`Login realizado como ${result.user.nome}`, 'success');
                checkLogin();
                setTimeout(() => {
                    window.location.href = 'pages/agendamento.html';
                }, 1500);
            } else {
                Utils.showNotification(result.message, 'error');
            }
        }

        function doLogout() {
            if (confirm('Deseja realmente fazer logout?')) {
                window.auth.logout();
                Utils.showNotification('Logout realizado com sucesso', 'success');
                checkLogin();
            }
        }

        function loadSystemData() {
            const clientes = window.db.getClientes();
            const agendamentos = window.db.getAgendamentos();
            const barbeirosAuth = window.db.getBarbeirosAuth();
            
            document.getElementById('totalClientes').textContent = clientes.length;
            document.getElementById('totalAgendamentos').textContent = agendamentos.length;
            document.getElementById('totalBarbeirosAuth').textContent = barbeirosAuth.length;
        }

        function resetDatabase() {
            if (confirm('Isso irá resetar todos os dados para o padrão. Continuar?')) {
                localStorage.removeItem('naRegua_clientes');
                localStorage.removeItem('naRegua_agendamentos');
                window.db.initializeDatabase();
                Utils.showNotification('Database resetado com sucesso', 'success');
                loadSystemData();
            }
        }

        function clearAll() {
            if (confirm('Isso irá DELETAR TODOS OS DADOS do sistema. Tem certeza?')) {
                localStorage.clear();
                Utils.showNotification('Todos os dados foram removidos', 'success');
                setTimeout(() => {
                    location.reload();
                }, 1500);
            }
        }
    </script>
</body>
</html>
